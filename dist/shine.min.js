/*! shine.js - v0.1.0 - 2014-04-09
* http://bigspaceship.github.io/shine.js
* Copyright (c) 2014 Big Spaceship; Licensed MIT */

!function(a,b){"use strict";b.shinejs=a,a.Color=function(a,b,c){this.r=a||0,this.g=b||0,this.b=c||0},a.Light=function(){this.position=new a.Point(0,0),this.intensity=1},a.Point=function(a,b){this.x=a||0,this.y=b||0},a.Point.prototype.delta=function(b){return new a.Point(b.x-this.x,b.y-this.y)},a.ShadowConfig=function(b){this.stepSize=8,this.maxSteps=5,this.opacityMultiplier=.15,this.opacityPow=1.2,this.offsetMultiplier=.15,this.offsetPow=1.8,this.blurMultiplier=.1,this.blurPow=1.4,this.maxBlurRadius=64,this.shadowRGB=new a.Color(0,0,0),this.applyValues(b)},a.ShadowConfig.prototype.applyValues=function(a){if(a)for(var b in this)b in a&&(this[b]=a[b])},a.Shadow=function(b,c){this.position=new a.Point(0,0),this.domElement=b,this.config=c,this.shadowProperty="textShadow",this.fnHandleViewportUpdate=null,this.enableAutoUpdates(),this.handleViewportUpdate()},a.Shadow.prototype.draw=function(a){var b=this.config,c=this.position.delta(a.position),d=Math.sqrt(c.x*c.x+c.y*c.y);d=Math.max(40,d);var e=d/b.stepSize;e=Math.min(b.maxSteps,Math.round(e));for(var f=[],g=0;e>g;g++){var h=g/e,i=Math.pow(h,b.opacityPow),j=Math.pow(h,b.offsetPow),k=Math.pow(h,b.blurPow),l=a.intensity*Math.max(0,b.opacityMultiplier*(1-i)),m=-b.offsetMultiplier*c.x*j,n=-b.offsetMultiplier*c.y*j,o=b.blurMultiplier*d*k;o=Math.min(b.maxBlurRadius,o);var p=this.getShadow(b.shadowRGB,l,m,n,o);f.push(p)}this.drawShadows(f)},a.Shadow.prototype.getShadow=function(a,b,c,d,e){var f="rgba("+a.r+", "+a.g+", "+a.b+", "+b+")";return f+" "+c+"px "+d+"px "+e+"px"},a.Shadow.prototype.drawShadows=function(a){this.domElement.style[this.shadowProperty]=a.join(", ")},a.Shadow.prototype.enableAutoUpdates=function(){this.disableAutoUpdates();var a=this,b=this.fnHandleViewportUpdate=function(){a.handleViewportUpdate()};document.addEventListener("resize",b,!1),document.addEventListener("load",b,!1),window.addEventListener("resize",b,!1),window.addEventListener("scroll",b,!1)},a.Shadow.prototype.disableAutoUpdates=function(){var a=this.fnHandleViewportUpdate;a&&(this.fnHandleViewportUpdate=null,document.removeEventListener("resize",a,!1),document.removeEventListener("load",a,!1),window.removeEventListener("resize",a,!1),window.removeEventListener("scroll",a,!1))},a.Shadow.prototype.handleViewportUpdate=function(){var a=this.domElement.getBoundingClientRect();this.position.x=a.left+.5*a.width,this.position.y=a.top+.5*a.height},a.Splitter=function(a,b){this.domElement=a,this.classPrefix=b||"",this.wrapperElement=document.createElement("div"),this.maskElement=document.createElement("div"),this.wordElements=[],this.elements=[],this.text=""},a.Splitter.prototype.split=function(a,b){this.text=a||this.text,this.wordElements.length=0,this.elements.length=0,this.wrapperElement.className=this.classPrefix+"wrapper",this.wrapperElement.innerHTML="",a&&(this.domElement.textContent=this.text),b?this.splitChildren(this.domElement,this.maskElement,this.wrapperElement,this.classPrefix):this.splitText(this.domElement,this.maskElement,this.wrapperElement,this.classPrefix)},a.Splitter.prototype.splitChildren=function(a,b,c,d){for(var e=a.childNodes,f=0;f<e.length;f++){var g=e[f];1===g.nodeType&&(g.className+=" "+d+"letter",c.appendChild(g),this.elements.push(g))}b.innerHTML=c.innerHTML,b.className=d+"mask",c.appendChild(b),a.innerHTML="",a.appendChild(c)},a.Splitter.prototype.splitText=function(a,b,c,d){for(var e=a.textContent,f=e.length,g=null,h=0;f>h;h++){var i=e.charAt(h);if(g||(g=document.createElement("span"),g.className=d+"word",c.appendChild(g),this.wordElements.push(g)),i.match(/[\s]/)){var j=document.createElement("span");j.className=d+"spacer",j.innerHTML=i,c.appendChild(j),g=null}else{var k=document.createElement("span");k.innerHTML=i,k.className=d+"letter",this.elements.push(k),g.appendChild(k),i.match(/[\W]/)&&(g=null)}}b.innerHTML=c.innerHTML,b.className=d+"mask",c.appendChild(b),a.innerHTML="",a.appendChild(c)},a.StyleInjector=function(){this.injections={}},a.StyleInjector.instance_=null,a.StyleInjector.getInstance=function(){return a.StyleInjector.instance_||(a.StyleInjector.instance_=new a.StyleInjector),a.StyleInjector.instance_},a.StyleInjector.prototype.inject=function(a,b){if(b=b||window.document,this.injections[a]!==b){var c=document.createElement("style");c.type="text/css",c.innerHTML=a;var d=b.getElementsByTagName("head")[0].firstChild;return b.getElementsByTagName("head")[0].insertBefore(c,d),this.injections[a]=b,c}},a.Shine=function(b,c,d,e){if(!b)throw new Error("No valid DOM element passed as first parameter");this.classPrefix=d||"shine-",this.shadowProperty=e||(this.elememtHasTextOnly(b)?"textShadow":"boxShadow"),this.domElement=b,this.light=new a.Light,this.config=c||new a.ShadowConfig,this.shadows=[],this.splitter=new a.Splitter(b,this.classPrefix),this.areAutoUpdatesEnabled=!0,this.fnDrawHandler=null,this.updateContent()},a.Shine.prototype.destroy=function(){this.disableAutoUpdates(),this.light=null,this.shadows=null,this.splitter=null,this.fnDrawHandler=null},a.Shine.prototype.draw=function(){for(var a=this.shadows.length-1;a>=0;a--)this.shadows[a].draw(this.light)},a.Shine.prototype.updateContent=function(b){var c=this.areAutoUpdatesEnabled;this.disableAutoUpdates(),a.StyleInjector.getInstance().inject(this.getCSS()),this.shadows.length=0,this.splitter.split(b,!this.elememtHasTextOnly(this.domElement));for(var d=this.getPrefixed(this.shadowProperty),e=0;e<this.splitter.elements.length;e++){var f=this.splitter.elements[e],g=new a.Shadow(f,this.config);g.shadowProperty=d,this.shadows.push(g)}c&&this.enableAutoUpdates(),this.draw()},a.Shine.prototype.enableAutoUpdates=function(){this.disableAutoUpdates(),this.areAutoUpdatesEnabled=!0;var a=this,b=this.fnDrawHandler=function(){a.draw()};window.addEventListener("scroll",b,!1),window.addEventListener("resize",b,!1);for(var c=this.shadows.length-1;c>=0;c--){var d=this.shadows[c];d.enableAutoUpdates()}},a.Shine.prototype.disableAutoUpdates=function(){this.areAutoUpdatesEnabled=!1;var a=this.fnDrawHandler;if(a){this.fnDrawHandler=null,window.removeEventListener("scroll",a,!1),window.removeEventListener("resize",a,!1);for(var b=this.shadows.length-1;b>=0;b--){var c=this.shadows[b];c.disableAutoUpdates()}}},a.Shine.prototype.getCSS=function(){return"/* shine.js styles */.shine-wrapper { display: inline-block; position: relative; max-width: 100%;}.shine-word { display: inline-block; white-space: nowrap;}.shine-letter { position: relative; display: inline-block;}.shine-mask { position: absolute; top: 0; left: 0; right: 0; bottom: 0;}"},a.Shine.prototype.getPrefixed=function(a){var b=this.domElement||document.createElement("div"),c=b.style;if(a in c)return a;for(var d=["webkit","ms","Moz","Webkit","O"],e=a.charAt(0).toUpperCase()+a.substring(1),f=0;f<d.length;f++){var g=d[f]+e;if(g in c)return g}return a},a.Shine.prototype.elememtHasTextOnly=function(a){var b=a.childNodes;if(!b||0===b.length)return!0;for(var c=0;c<b.length;c++)if(3!==b[c].nodeType)return!1;return!0},b.Shine=b.Shine||a.Shine}({},function(){return this}());
//# sourceMappingURL=shine.min.map